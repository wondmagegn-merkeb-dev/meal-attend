{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 31, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,gKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,8OAAC;QACC,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 91, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 172, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,8OAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 201, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,gBAAgB,CAAA,GAAA,gKAAA,CAAA,MAAG,AAAD,EACtB;AAGF,MAAM,sBAAQ,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAI3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,iKAAA,CAAA,OAAmB;QAClB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE,iBAAiB;QAC9B,GAAG,KAAK;;;;;;AAGb,MAAM,WAAW,GAAG,iKAAA,CAAA,OAAmB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 233, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/ui/checkbox.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;AAEA;AANA;;;;;;AAQA,MAAM,yBAAW,CAAA,GAAA,qMAAA,CAAA,aAAgB,AAAD,EAG9B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,8OAAC,oKAAA,CAAA,OAAsB;QACrB,KAAK;QACL,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EACV,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,8OAAC,oKAAA,CAAA,YAA2B;YAC1B,WAAW,CAAA,GAAA,mHAAA,CAAA,KAAE,AAAD,EAAE;sBAEd,cAAA,8OAAC,oMAAA,CAAA,QAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,oKAAA,CAAA,OAAsB,CAAC,WAAW","debugId":null}},
    {"offset": {"line": 278, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/constants.ts"],"sourcesContent":["\nexport const WELCOME_BANNER_DISMISSED_KEY = 'mealAttendWelcomeBannerDismissed_v1';\nexport const STUDENTS_STORAGE_KEY = 'mealAttendStudentsList_v1';\nexport const USERS_STORAGE_KEY = 'mealAttendUsersList_v1';\nexport const DEPARTMENTS_STORAGE_KEY = 'mealAttendDepartmentsList_v1';\nexport const ATTENDANCE_RECORDS_STORAGE_KEY = 'mealAttendAttendanceRecords_v1';\nexport const AUTH_TOKEN_KEY = 'mealAttendAuthToken_v1';\nexport const CURRENT_USER_ROLE_KEY = 'mealAttendCurrentUserRole_v1';\nexport const CURRENT_USER_ID_KEY = 'mealAttendCurrentUserId_v1';\nexport const CURRENT_USER_DETAILS_KEY = 'mealAttendCurrentUserDetails_v1';\nexport const PASSWORD_CHANGE_REQUIRED_KEY_PREFIX = 'mealAttendPasswordChangeRequired_';\nexport const USER_ACTIVITY_LOG_KEY = 'mealAttendUserActivityLog_v1'; // New key for activity logs\n    \n"],"names":[],"mappings":";;;;;;;;;;;;;AACO,MAAM,+BAA+B;AACrC,MAAM,uBAAuB;AAC7B,MAAM,oBAAoB;AAC1B,MAAM,0BAA0B;AAChC,MAAM,iCAAiC;AACvC,MAAM,iBAAiB;AACvB,MAAM,wBAAwB;AAC9B,MAAM,sBAAsB;AAC5B,MAAM,2BAA2B;AACjC,MAAM,sCAAsC;AAC5C,MAAM,wBAAwB,gCAAgC,4BAA4B","debugId":null}},
    {"offset": {"line": 308, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/activityLogger.ts"],"sourcesContent":["\nimport type { UserActivityLog } from \"@prisma/client\";\n\nexport async function logUserActivity(userIdentifier: string | null, action: string, details?: string) {\n  const effectiveUserId = userIdentifier || 'unknown_user';\n\n  const logData: Partial<Omit<UserActivityLog, 'id' | 'createdAt'>> = {\n    userIdentifier: effectiveUserId,\n    action,\n    details: details || null,\n    activityTimestamp: new Date(),\n  };\n\n  try {\n    await fetch('/api/activity-logs', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(logData),\n    });\n  } catch (error) {\n    console.error(\"Failed to log user activity to API:\", error);\n  }\n}\n"],"names":[],"mappings":";;;AAGO,eAAe,gBAAgB,cAA6B,EAAE,MAAc,EAAE,OAAgB;IACnG,MAAM,kBAAkB,kBAAkB;IAE1C,MAAM,UAA8D;QAClE,gBAAgB;QAChB;QACA,SAAS,WAAW;QACpB,mBAAmB,IAAI;IACzB;IAEA,IAAI;QACF,MAAM,MAAM,sBAAsB;YAChC,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uCAAuC;IACvD;AACF","debugId":null}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/hooks/useAuth.ts"],"sourcesContent":["\n\"use client\";\n\nimport type { Dispatch, SetStateAction} from 'react';\nimport { useState, useEffect, useCallback } from 'react';\nimport { useRouter, usePathname } from 'next/navigation';\nimport { AUTH_TOKEN_KEY, CURRENT_USER_DETAILS_KEY } from '@/lib/constants';\nimport { useToast } from './use-toast';\nimport type { User, Department } from '@prisma/client';\nimport { logUserActivity } from '@/lib/activityLogger';\n\nexport interface UserWithDepartment extends User {\n  department: Department | null;\n}\n\ninterface AuthContextType {\n  isAuthenticated: boolean | null;\n  currentUser: UserWithDepartment | null;\n  currentUserRole: User['role'] | null;\n  currentUserId: string | null; // ADERA User ID\n  isPasswordChangeRequired: boolean;\n  login: (userIdInput: string, password?: string) => Promise<boolean>;\n  logout: () => void;\n  changePassword: (newPassword: string) => Promise<boolean>;\n  setIsAuthenticated: Dispatch<SetStateAction<boolean | null>>;\n  updateAuthContextUser: (updatedUser: UserWithDepartment) => void;\n}\n\nexport function useAuth(): AuthContextType {\n  const [isAuthenticated, setIsAuthenticated] = useState<boolean | null>(null);\n  const [currentUser, setCurrentUser] = useState<UserWithDepartment | null>(null);\n  const [isPasswordChangeRequired, setIsPasswordChangeRequired] = useState<boolean>(false);\n  const router = useRouter();\n  const pathname = usePathname();\n  const { toast } = useToast();\n\n  const currentUserRole = currentUser?.role || null;\n  const currentUserId = currentUser?.userId || null;\n\n  useEffect(() => {\n    try {\n      const token = localStorage.getItem(AUTH_TOKEN_KEY);\n      const storedUserDetailsRaw = localStorage.getItem(CURRENT_USER_DETAILS_KEY);\n      \n      if (token && storedUserDetailsRaw) {\n        const storedUser: UserWithDepartment = JSON.parse(storedUserDetailsRaw);\n        setIsAuthenticated(true);\n        setCurrentUser(storedUser);\n        setIsPasswordChangeRequired(storedUser.passwordChangeRequired);\n      } else {\n        setIsAuthenticated(false);\n        setCurrentUser(null);\n        setIsPasswordChangeRequired(false);\n      }\n    } catch (e) {\n      console.error(\"localStorage access error:\", e);\n      setIsAuthenticated(false);\n      setCurrentUser(null);\n      setIsPasswordChangeRequired(false);\n    }\n  }, []);\n\n  const login = useCallback(async (userIdInput: string, password?: string): Promise<boolean> => {\n    try {\n      const response = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ userId: userIdInput, password }),\n      });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        logUserActivity(userIdInput, \"LOGIN_FAILURE\", data.message || 'Invalid credentials');\n        toast({ title: \"Login Failed\", description: data.message || \"Invalid User ID or password.\", variant: \"destructive\" });\n        return false;\n      }\n\n      const user: UserWithDepartment = data.user;\n      localStorage.setItem(AUTH_TOKEN_KEY, `mock-jwt-for-${user.userId}`);\n      localStorage.setItem(CURRENT_USER_DETAILS_KEY, JSON.stringify(user));\n      \n      setIsAuthenticated(true);\n      setCurrentUser(user);\n      setIsPasswordChangeRequired(user.passwordChangeRequired);\n      \n      logUserActivity(user.userId, \"LOGIN_SUCCESS\");\n      toast({ title: \"Login Successful\", description: `Welcome back, ${user.fullName}!` });\n      \n      if (user.passwordChangeRequired) {\n        router.push('/auth/change-password');\n      } else {\n        router.push('/admin');\n      }\n      return true;\n\n    } catch (error) {\n      console.error(\"Login API error:\", error);\n      logUserActivity(userIdInput, \"LOGIN_ERROR\", (error as Error).message);\n      toast({ title: \"Login Error\", description: \"An unexpected error occurred.\", variant: \"destructive\" });\n      return false;\n    }\n  }, [toast, router]); \n\n  const logout = useCallback(() => {\n    const loggingOutUserId = currentUser?.userId || null;\n    try {\n      localStorage.removeItem(AUTH_TOKEN_KEY);\n      localStorage.removeItem(CURRENT_USER_DETAILS_KEY);\n\n      setIsAuthenticated(false);\n      setCurrentUser(null);\n      setIsPasswordChangeRequired(false); \n      \n      if (loggingOutUserId) {\n        logUserActivity(loggingOutUserId, \"LOGOUT_SUCCESS\");\n      }\n      toast({ title: \"Logged Out\", description: \"You have been successfully logged out.\" });\n      router.push('/auth/login');\n    } catch (e) {\n        console.error(\"Logout error:\", e);\n    }\n  }, [router, toast, currentUser]);\n\n  const changePassword = useCallback(async (newPassword: string): Promise<boolean> => {\n    if (!currentUser) {\n      toast({ title: \"Error\", description: \"No active user session found.\", variant: \"destructive\" });\n      return false;\n    }\n\n    try {\n      const response = await fetch(`/api/users/${currentUser.id}`, {\n        method: 'PUT',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ password: newPassword, passwordChangeRequired: false }),\n      });\n\n      if (!response.ok) {\n        const errorData = await response.json();\n        throw new Error(errorData.message || 'Failed to update password.');\n      }\n      \n      const updatedUser = await response.json();\n      setCurrentUser(updatedUser);\n      localStorage.setItem(CURRENT_USER_DETAILS_KEY, JSON.stringify(updatedUser));\n      setIsPasswordChangeRequired(false);\n      logUserActivity(currentUser.userId, \"PASSWORD_CHANGE_API_SUCCESS\");\n      return true;\n\n    } catch (e) {\n      const error = e as Error;\n      console.error(\"Error changing password:\", error);\n      toast({ title: \"Update Failed\", description: error.message, variant: \"destructive\" });\n      logUserActivity(currentUser.userId, \"PASSWORD_CHANGE_FAILURE\", error.message);\n      return false;\n    }\n  }, [currentUser, toast]);\n\n  const updateAuthContextUser = useCallback((updatedUser: UserWithDepartment) => {\n    setCurrentUser(updatedUser);\n    localStorage.setItem(CURRENT_USER_DETAILS_KEY, JSON.stringify(updatedUser));\n    // This function is for context updates after an API call, e.g., profile edit.\n    // The API call itself is handled in the component.\n  }, []);\n\n  return { \n    isAuthenticated, \n    currentUser,\n    currentUserRole, \n    currentUserId, \n    isPasswordChangeRequired, \n    login, \n    logout, \n    changePassword, \n    setIsAuthenticated,\n    updateAuthContextUser\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 528, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/auth/login/page.tsx"],"sourcesContent":["\n\"use client\";\n\nimport { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { useRouter } from 'next/navigation';\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardFooter, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { useAuth } from '@/hooks/useAuth';\nimport { Loader2, LogIn, Salad, Eye, EyeOff } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\n\nexport default function LoginPage() {\n  const [userId, setUserId] = useState('');\n  const [password, setPassword] = useState('');\n  const [showPassword, setShowPassword] = useState(false);\n  const [rememberMe, setRememberMe] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  const { login } = useAuth();\n  const router = useRouter();\n  const { toast } = useToast();\n\n  useEffect(() => {\n    const rememberedUserId = localStorage.getItem('rememberedUserId');\n    if (rememberedUserId) {\n      setUserId(rememberedUserId);\n      setRememberMe(true);\n    }\n  }, []); // Run only on component mount\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n    if (!userId || !password) {\n      toast({\n        title: \"Missing Fields\",\n        description: \"Please enter both User ID and password.\",\n        variant: \"destructive\",\n      });\n      setIsLoading(false);\n      return;\n    }\n    \n    const success = await login(userId, password);\n    \n    if (success) {\n      if (rememberMe) {\n        localStorage.setItem('rememberedUserId', userId);\n      } else {\n        localStorage.removeItem('rememberedUserId');\n      }\n      // The router push is handled inside the login function now\n    }\n    setIsLoading(false);\n  };\n\n  return (\n    <div className=\"flex items-center justify-center min-h-screen bg-gradient-to-br from-sky-100 via-blue-50 to-indigo-100 p-4 sm:p-8\">\n      <div className=\"flex flex-col md:flex-row w-full max-w-4xl shadow-2xl rounded-xl overflow-hidden bg-card\">\n        {/* Decorative Left Panel */}\n        <div className=\"hidden md:flex md:w-2/5 bg-primary text-primary-foreground flex-col items-start justify-center p-8 sm:p-12 space-y-6\">\n          <h1 className=\"text-4xl lg:text-5xl font-bold tracking-tight\">WELCOME</h1>\n          <h2 className=\"text-xl lg:text-2xl font-semibold\">MealAttend System</h2>\n          <p className=\"text-sm text-primary-foreground/80 leading-relaxed\">\n            Efficiently manage and track meal attendance with ease. Sign in to access your dashboard and tools.\n          </p>\n        </div>\n\n        {/* Login Form Right Panel */}\n        <div className=\"flex-1 p-6 sm:p-10 bg-card\">\n          <Card className=\"border-none shadow-none w-full\">\n            <CardHeader className=\"text-left p-0 pb-6\">\n              <div className=\"flex justify-center mb-4 md:hidden\">\n                <Salad className=\"h-12 w-12 text-primary\" />\n              </div>\n              <CardTitle className=\"text-3xl font-bold\">Sign in</CardTitle>\n              <CardDescription className=\"text-muted-foreground\">\n                Enter your credentials to access your account.\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"p-0\">\n              <form onSubmit={handleLogin} className=\"space-y-6\">\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"userId\">User ID</Label>\n                  <Input\n                    id=\"userId\"\n                    type=\"text\"\n                    placeholder=\"e.g., ADERA/USR/2024/00001\"\n                    value={userId}\n                    onChange={(e) => setUserId(e.target.value)}\n                    required\n                    disabled={isLoading}\n                    className=\"h-11\"\n                  />\n                </div>\n                <div className=\"space-y-2\">\n                  <Label htmlFor=\"password\">Password</Label>\n                  <div className=\"relative\">\n                    <Input\n                      id=\"password\"\n                      type={showPassword ? \"text\" : \"password\"}\n                      placeholder=\"••••••••\"\n                      value={password}\n                      onChange={(e) => setPassword(e.target.value)}\n                      required\n                      disabled={isLoading}\n                      className=\"h-11 pr-10\"\n                    />\n                    <Button\n                      type=\"button\"\n                      variant=\"ghost\"\n                      size=\"sm\"\n                      className=\"absolute right-1 top-1/2 -translate-y-1/2 h-7 px-2 text-muted-foreground hover:bg-transparent\"\n                      onClick={() => setShowPassword(!showPassword)}\n                      aria-label={showPassword ? \"Hide password\" : \"Show password\"}\n                    >\n                      {showPassword ? <EyeOff className=\"h-5 w-5\" /> : <Eye className=\"h-5 w-5\" />}\n                    </Button>\n                  </div>\n                </div>\n                <div className=\"flex items-center justify-between text-sm\">\n                  <div className=\"flex items-center gap-2\">\n                    <Checkbox \n                      id=\"rememberMe\" \n                      checked={rememberMe}\n                      onCheckedChange={(checked) => setRememberMe(checked as boolean)}\n                      disabled={isLoading}\n                    />\n                    <Label htmlFor=\"rememberMe\" className=\"font-normal text-muted-foreground\">Remember me</Label>\n                  </div>\n                  <Link href=\"/auth/forgot-password\" legacyBehavior>\n                    <a className=\"text-primary hover:underline hover:text-primary/80\">\n                      Forgot Password?\n                    </a>\n                  </Link>\n                </div>\n                <Button type=\"submit\" className=\"w-full h-11 text-base\" disabled={isLoading}>\n                  {isLoading ? (\n                    <Loader2 className=\"mr-2 h-5 w-5 animate-spin\" />\n                  ) : (\n                    <LogIn className=\"mr-2 h-5 w-5\" />\n                  )}\n                  Sign In\n                </Button>\n              </form>\n            </CardContent>\n            <CardFooter className=\"flex-col items-center space-y-2 pt-6 p-0\">\n              {/* Hint has been removed */}\n            </CardFooter>\n          </Card>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAZA;;;;;;;;;;;;;AAce,SAAS;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,uHAAA,CAAA,UAAO,AAAD;IACxB,MAAM,SAAS,CAAA,GAAA,kIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,4HAAA,CAAA,WAAQ,AAAD;IAEzB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,mBAAmB,aAAa,OAAO,CAAC;QAC9C,IAAI,kBAAkB;YACpB,UAAU;YACV,cAAc;QAChB;IACF,GAAG,EAAE,GAAG,8BAA8B;IAEtC,MAAM,cAAc,OAAO;QACzB,EAAE,cAAc;QAChB,aAAa;QACb,IAAI,CAAC,UAAU,CAAC,UAAU;YACxB,MAAM;gBACJ,OAAO;gBACP,aAAa;gBACb,SAAS;YACX;YACA,aAAa;YACb;QACF;QAEA,MAAM,UAAU,MAAM,MAAM,QAAQ;QAEpC,IAAI,SAAS;YACX,IAAI,YAAY;gBACd,aAAa,OAAO,CAAC,oBAAoB;YAC3C,OAAO;gBACL,aAAa,UAAU,CAAC;YAC1B;QACA,2DAA2D;QAC7D;QACA,aAAa;IACf;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BAEb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAgD;;;;;;sCAC9D,8OAAC;4BAAG,WAAU;sCAAoC;;;;;;sCAClD,8OAAC;4BAAE,WAAU;sCAAqD;;;;;;;;;;;;8BAMpE,8OAAC;oBAAI,WAAU;8BACb,cAAA,8OAAC,gIAAA,CAAA,OAAI;wBAAC,WAAU;;0CACd,8OAAC,gIAAA,CAAA,aAAU;gCAAC,WAAU;;kDACpB,8OAAC;wCAAI,WAAU;kDACb,cAAA,8OAAC,oMAAA,CAAA,QAAK;4CAAC,WAAU;;;;;;;;;;;kDAEnB,8OAAC,gIAAA,CAAA,YAAS;wCAAC,WAAU;kDAAqB;;;;;;kDAC1C,8OAAC,gIAAA,CAAA,kBAAe;wCAAC,WAAU;kDAAwB;;;;;;;;;;;;0CAIrD,8OAAC,gIAAA,CAAA,cAAW;gCAAC,WAAU;0CACrB,cAAA,8OAAC;oCAAK,UAAU;oCAAa,WAAU;;sDACrC,8OAAC;4CAAI,WAAU;;8DACb,8OAAC,iIAAA,CAAA,QAAK;oDAAC,SAAQ;8DAAS;;;;;;8DACxB,8OAAC,iIAAA,CAAA,QAAK;oDACJ,IAAG;oDACH,MAAK;oDACL,aAAY;oDACZ,OAAO;oDACP,UAAU,CAAC,IAAM,UAAU,EAAE,MAAM,CAAC,KAAK;oDACzC,QAAQ;oDACR,UAAU;oDACV,WAAU;;;;;;;;;;;;sDAGd,8OAAC;4CAAI,WAAU;;8DACb,8OAAC,iIAAA,CAAA,QAAK;oDAAC,SAAQ;8DAAW;;;;;;8DAC1B,8OAAC;oDAAI,WAAU;;sEACb,8OAAC,iIAAA,CAAA,QAAK;4DACJ,IAAG;4DACH,MAAM,eAAe,SAAS;4DAC9B,aAAY;4DACZ,OAAO;4DACP,UAAU,CAAC,IAAM,YAAY,EAAE,MAAM,CAAC,KAAK;4DAC3C,QAAQ;4DACR,UAAU;4DACV,WAAU;;;;;;sEAEZ,8OAAC,kIAAA,CAAA,SAAM;4DACL,MAAK;4DACL,SAAQ;4DACR,MAAK;4DACL,WAAU;4DACV,SAAS,IAAM,gBAAgB,CAAC;4DAChC,cAAY,eAAe,kBAAkB;sEAE5C,6BAAe,8OAAC,0MAAA,CAAA,SAAM;gEAAC,WAAU;;;;;qFAAe,8OAAC,gMAAA,CAAA,MAAG;gEAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;sDAItE,8OAAC;4CAAI,WAAU;;8DACb,8OAAC;oDAAI,WAAU;;sEACb,8OAAC,oIAAA,CAAA,WAAQ;4DACP,IAAG;4DACH,SAAS;4DACT,iBAAiB,CAAC,UAAY,cAAc;4DAC5C,UAAU;;;;;;sEAEZ,8OAAC,iIAAA,CAAA,QAAK;4DAAC,SAAQ;4DAAa,WAAU;sEAAoC;;;;;;;;;;;;8DAE5E,8OAAC,4JAAA,CAAA,UAAI;oDAAC,MAAK;oDAAwB,cAAc;8DAC/C,cAAA,8OAAC;wDAAE,WAAU;kEAAqD;;;;;;;;;;;;;;;;;sDAKtE,8OAAC,kIAAA,CAAA,SAAM;4CAAC,MAAK;4CAAS,WAAU;4CAAwB,UAAU;;gDAC/D,0BACC,8OAAC,iNAAA,CAAA,UAAO;oDAAC,WAAU;;;;;yEAEnB,8OAAC,wMAAA,CAAA,QAAK;oDAAC,WAAU;;;;;;gDACjB;;;;;;;;;;;;;;;;;;0CAKR,8OAAC,gIAAA,CAAA,aAAU;gCAAC,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQlC","debugId":null}}]
}